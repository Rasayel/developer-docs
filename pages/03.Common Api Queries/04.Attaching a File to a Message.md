# How to Attach a File to a Message with GraphQL

## Introduction

In this guide, we will walk you through the process of attaching a file to a message using GraphQL. This process involves three main steps and utilizes the [Upload Information Type](/types/uploadinformation) and [Message Type](/types/Message).

## Step-by-Step Guide

### Step 1: Get an Upload Link

First, use the `attachmentUpload` mutation to obtain an `uploadUrl`, `headers`, and `attachmentId` in the response. Make sure to store all three values, as you'll need them later.

```graphql
mutation UploadAttachment($filename: String!, bytesize: Int!, checksum: String!, contentType: String!) {
  attachmentUpload (input: {fileInput: {filename: $filename, byteSize: $bytesize, checksum: $checksum, contentType: $contentType}}) {
      uploadInformation {
        uploadUrl
        headers
        attachmentId
    }
  }
}
```

### Step 2: Upload the File

This step depends on your specific platform. Upload the file to the `uploadUrl` obtained in Step 1. Remember to include the headers from the response of the previous step.

### Step 3: Send the Message

This step uses the `attachmentId` from Step 1. Pass it into the mutation's variables as the `blobOrAttachmentId`. In this example, we are using `templateProactiveMessageCreate` to create a proactive message to a user using a template. The same workflow applies for [Media Message Create](/mutations/mediaMessageCreate).

This uses the `MessageProactiveTemplateCreateInput` [input type](/types/MessageProactiveTemplateCreateInput).

```graphql
mutation SendProactiveTemplateMessageWithFile(
  $input: MessageProactiveTemplateCreateInput!
) {
  templateProactiveMessageCreate(input: $input) {
    id
  }
}
```

In your variables, `$input` could look like this:

```json
{
  "input": {
    "channelId": 42,
    "receiver": "+353800000000",
    "clientMutationId": "clientMutationId",
    "messageTemplateId": 42,
    "components": [
      {
        "type": "HEADER",
        "subtype": "QUICK_REPLY",
        "parameters": [
          {
            "type": "IMAGE",
            "blobOrAttachmentId": "blobOrAttachmentId" // the value we retrieved from step 1, the attachment ID
          }
        ]
      }
    ],
    "conversationState": "UNANSWERED"
  }
}
```
